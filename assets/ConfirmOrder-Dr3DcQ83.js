import{u as M,b as d,c as _,a as m,ar as I,i as B,j as e,as as P,at as S,au as W,av as Z,aw as L,ax as U,ay as Y,az as G}from"./index-D9mZNI-p.js";import{h as V}from"./index-DXDLMGRq.js";import{u as H}from"./index.esm-kBbFVbxb.js";import{s as J,b as K,c as Q}from"./cartSelectors-CS9rDrmx.js";import{D as X}from"./DarkButtonLinearG-D4CTZws2.js";import{O as o}from"./OutlineButton-D0rhEp2m.js";import{s as ee}from"./orderSelectors-IQfpEEFc.js";import{B as se}from"./ButtonLoading-C8SUr9DS.js";import{c as ae}from"./reselect-CiXCCDx7.js";import"./animation-DR5N1PjO.js";const le=t=>t.coupon,te=ae([le],t=>t.isCouponLoading);function pe(){var g,y,C,w,k;const t=M(),a=d(J),i=d(K),u=d(ee),D=d(Q),$=d(te),p=_(),[j,N]=m.useState(!1),[v,f]=m.useState([]),[F,O]=m.useState(""),b=(s,r,n)=>{t(Z({cartId:s,product_id:r,qty:n}))},q=s=>{const{checked:r,value:n}=s.target,x=n;f(r?h=>[...h,x]:h=>h.filter(R=>R!==x))},A=()=>{v.forEach(s=>{t(L(s))})},{register:c,handleSubmit:T,reset:z,formState:{errors:l}}=H({mode:"onTouched"}),E=s=>{const{message:r,...n}=s,x={data:{user:n,message:r,deliveryFee:i}};t(U(i)),t(Y((a==null?void 0:a.total)-(a==null?void 0:a.final_total))),t(G(x)),z()};return m.useEffect(()=>{u&&(p("/cart/payment"),t(I(!1)))},[u,p,t]),m.useEffect(()=>{t(B())},[t]),e.jsxs(e.Fragment,{children:[e.jsx("section",{children:e.jsx("div",{className:"progress-bar py-4 mb-7",children:e.jsxs("div",{className:"d-flex justify-content-center align-items-center",children:[e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"number-ball bg-primary-100 rounded-pill me-2",children:e.jsx("p",{className:"text-white",children:"1"})}),e.jsx("p",{className:"  text-neutral-60",children:"確認訂單"})]}),e.jsx("span",{className:"ms-2 me-2 ms-sm-4 me-sm-4 number-line"}),e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"number-ball bg-neutral-60 rounded-pill me-2",children:e.jsx("p",{className:"text-white",children:"2"})}),e.jsx("p",{className:"d-none d-sm-block text-neutral-60",children:"確認付款"})]}),e.jsx("span",{className:"ms-2 me-2 ms-sm-4 me-sm-4 number-line"}),e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"number-ball bg-neutral-60 rounded-pill me-2",children:e.jsx("p",{className:"text-white",children:"3"})}),e.jsx("p",{className:"d-none d-sm-block text-neutral-60",children:"訂單完成"})]})]})})}),e.jsx("div",{className:"pb-11 pb-sm-14",children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-0 col-lg-8",children:[e.jsx("section",{children:e.jsx("div",{className:"pb-3 pb-sm-0",children:((g=a.carts)==null?void 0:g.length)===0?e.jsx("section",{children:e.jsxs("div",{className:"cart-empty react-icon bg-white rounded-3 text-neutral-60",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(V,{className:"cart-empty-icon "}),e.jsxs("h6",{className:"fs-6",lang:"zh-TW",children:["購物車空空如也",e.jsx("span",{className:"d-none d-lg-inline",children:","}),e.jsx("br",{className:"d-lg-none"}),"趕緊挑個心愛的衝浪板吧！"]})]}),e.jsx("div",{className:"d-flex justify-content-center pt-9",children:e.jsx(X,{btnName:"去看商品",btnType:"btn-dark",destination:"/products"})})]})}):e.jsx("section",{children:e.jsxs("div",{className:"bg-white rounded-3 px-3",children:[e.jsxs("div",{className:"d-flex w-100 py-7  border-bottom ",children:[e.jsx("div",{className:"ms-4",children:e.jsx(o,{btnName:"清空購物車",btnColor:"neutral-60",event:()=>t(P())})}),e.jsx("div",{className:"ms-auto d-flex",children:j?e.jsxs("div",{className:"d-flex",children:[e.jsx(o,{event:()=>N(!1),btnName:"取消編輯",btnColor:"neutral-60"}),e.jsx("div",{className:"ms-3",children:e.jsx(o,{event:A,btnName:"刪除",btnColor:"accent-100"})}),e.jsxs("p",{className:"text-accent-100 ms-2",children:["(已選",v.length,"項)"]})]}):e.jsx("div",{className:"me-4",children:e.jsx(o,{disabled:((y=a==null?void 0:a.length)==null?void 0:y.length)===0,event:()=>N(!0),btnName:"編輯",btnColor:"neutral-60"})})})]}),e.jsx("div",{children:(C=a.carts)==null?void 0:C.map(s=>e.jsxs("div",{className:"form-check d-flex align-items-center w-100 p-3 p-lg-4  border-bottom",children:[j&&e.jsx("input",{style:{height:"24px",width:"24px"},className:"form-check-input me-4 ms-0 mt-0 ",type:"checkbox",onChange:r=>q(r),value:s.id,id:`product-check${s.id}}`}),e.jsx("label",{className:"form-check-label p-3 p-lg-4 w-100",htmlFor:`product-check${s.id}}`,children:e.jsxs("div",{className:" w-100 d-flex",children:[e.jsx("img",{className:"object-fit-cover shopping-cart-product-img",src:s.product.imageUrl,alt:"surf-board"}),e.jsxs("div",{className:"d-flex flex-column flex-sm-row align-items-sm-center justify-content-sm-between ms-2 gap-4 w-100",children:[e.jsx("p",{className:"fs-lg-5 mb-lg-4 h5",children:s.product.title}),e.jsxs("p",{className:"text-nowrap ms-auto me-2 lh-base",children:["NT$ ",s.total.toLocaleString()]}),e.jsx("div",{className:"w-sm-100 d-flex",children:e.jsxs("div",{className:"btn-group btn-group-sm ms-sm-auto",role:"group","aria-label":"Small button group",children:[e.jsx("button",{type:"button",className:"btn btn-outline-neutral-40 text-neutral-80 px-0",style:{width:"40px"},onClick:()=>{b(s.id,s.product_id,s.qty+1)},children:"+"}),e.jsx("span",{className:"btn border border-neutral-40 px-0",style:{width:"48px",cursor:"auto"},children:s.qty}),e.jsx("button",{type:"button",className:"btn btn-outline-neutral-40 text-neutral-80 px-1",style:{width:"40px"},onClick:()=>{b(s.id,s.product_id,s.qty-1)},disabled:s.qty===1,children:"-"})]})})]})]})})]},s.id))})]})})})}),e.jsx("section",{children:e.jsx("div",{className:"py-3 pt-sm-11 ",children:e.jsxs("form",{className:"bg-white p-3 rounded-3",onSubmit:T(E),id:"orderForm",children:[e.jsxs("div",{className:"pb-4",children:[e.jsx("div",{className:"py-3",children:e.jsx("h6",{children:"收貨人資訊"})}),e.jsxs("div",{className:"text-neutral-60",children:[e.jsxs("div",{className:"row row-cols-1 row-cols-sm-2 py-3",children:[e.jsx("div",{className:"col",children:e.jsxs("div",{className:"pb-3",children:[e.jsxs("label",{htmlFor:"name",className:"form-label fs-8",children:["姓名",e.jsx("span",{className:"ms-1 text-accent-100",children:"*"})]}),e.jsx("input",{...c("name",{required:{value:!0,message:"請填寫收件人姓名"}}),placeholder:"glen",type:"text",className:`form-control fs-7 ${l.name&&"is-invalid"}`,id:"name"}),l.name&&e.jsx("div",{className:"invalid-feedback",children:l.name.message})]})}),e.jsx("div",{className:"col",children:e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"tel",className:"form-label fs-8",children:["聯絡電話",e.jsx("span",{className:"ms-1 text-accent-100",children:"*"})]}),e.jsx("input",{...c("tel",{required:{value:!0,message:"請輸入電話號碼"},pattern:{value:/^(0[2-8]\d{7}|09\d{8})$/,message:"電話格式錯誤"}}),type:"tel",className:`form-control fs-7 ${l.tel&&"is-invalid"}`,id:"tel",placeholder:"0912345678"}),l.tel&&e.jsx("div",{className:"invalid-feedback",children:l.tel.message})]})})]}),e.jsxs("div",{className:"row row-cols-1 row-cols-sm-2 py-3",children:[e.jsx("div",{className:"col",children:e.jsxs("div",{className:"pb-3",children:[e.jsxs("label",{htmlFor:"email",className:"form-label fs-8",children:["Email",e.jsx("span",{className:"ms-1 text-accent-100",children:"*"})]}),e.jsx("input",{...c("email",{required:{value:!0,message:"請填入email"},pattern:{value:/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,message:"email格式錯誤"}}),type:"email",className:`form-control fs-7 ${l.email&&"is-invalid"}`,id:"email",placeholder:"example@gmail.com"}),l.email&&e.jsx("div",{className:"invalid-feedback",children:l.email.message})]})}),e.jsx("div",{className:"col",children:e.jsxs("div",{className:"pb-3",children:[e.jsxs("label",{htmlFor:"address",className:"form-label fs-8",children:["配送地址",e.jsx("span",{className:"ms-1 text-accent-100",children:"*"})]}),e.jsx("input",{...c("address",{required:{value:!0,message:"請填入收件人地址"}}),type:"text",className:`form-control fs-7 ${l.address&&"is-invalid"}`,id:"address",placeholder:"100台北市中正區重慶南路一段122號"}),l.address&&e.jsx("div",{className:"invalid-feedback",children:l.address.message})]})})]}),e.jsxs("div",{className:"py-3",children:[e.jsx("label",{htmlFor:"message",className:"form-label fs-8",children:"留言給賣家"}),e.jsx("textarea",{...c("message"),type:"text",className:"form-control fs-7",style:{resize:"none"},id:"message",rows:"5"})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"pt-4",children:[e.jsx("div",{className:"pb-3",children:e.jsx("h6",{children:"付款方式"})}),e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"py-3",children:e.jsx("div",{style:{backgroundColor:"rgba(255,255,255,0.1)",borderRadius:"16px"},children:e.jsxs("div",{className:"form-check me-7",children:[e.jsx("input",{className:"form-check-input",defaultChecked:!0,value:"cashOnDelivery",type:"radio",name:"flexRadioDefault",id:"flexRadioDefault1",onChange:s=>t(S(s.target.value))}),e.jsx("label",{className:"form-check-label align-middle ",htmlFor:"flexRadioDefault1",children:"貨到付款"})]})})}),e.jsx("div",{children:e.jsx("div",{style:{backgroundColor:"rgba(255,255,255,0.1)",borderRadius:"16px"},children:e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",value:"creditCard",type:"radio",name:"flexRadioDefault",id:"credit-card",onChange:s=>t(S(s.target.value))}),e.jsx("label",{className:"form-check-label",htmlFor:"credit-card",children:"信用卡"})]})})})]})]}),D==="creditCard"&&e.jsxs("div",{className:"pt-2 fs-8 text-neutral-60",children:[e.jsxs("div",{className:"py-3",children:[e.jsxs("label",{htmlFor:"creditNum",className:"form-label",children:["信用卡號",e.jsx("span",{className:"ms-1 text-accent-100",children:"*"})]}),e.jsx("input",{...c("creditNum",{required:{value:!0,message:"請填入信用卡卡號"},pattern:{value:/^\d{13,16}$/,message:"信用卡格式錯誤"}}),className:`form-control ${l.creditNum&&"is-invalid"}`,id:"creditCard",type:"tel",inputMode:"numeric",autoComplete:"cc-number",maxLength:"16",placeholder:"0000 0000 0000 0000"}),l.creditNum&&e.jsx("div",{className:"invalid-feedback",children:l.creditNum.message})]}),e.jsx("div",{className:"py-3",children:e.jsxs("div",{className:"row row-cols-2",children:[e.jsx("div",{className:"col",children:e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"expireDate",className:"form-label ",children:["有效期限",e.jsx("span",{className:"ms-1 text-accent-100",children:"*"})]}),e.jsx("input",{...c("expireDate",{required:{value:!0,message:"請填入信用卡有效期"},pattern:{value:/^(0[1-9]|1[0-2])\d{2}$/,message:"日期格式錯誤"}}),type:"tel",className:`form-control fs-7 ${l.expireDate&&"is-invalid"}`,id:"expireDate",maxLength:"4",placeholder:"MM/YY"}),l.expireDate&&e.jsx("div",{className:"invalid-feedback",children:l.expireDate.message})]})}),e.jsx("div",{className:"col",children:e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"securityNum",className:"form-label",children:["安全碼",e.jsx("span",{className:"ms-1 text-accent-100",children:"*"})]}),e.jsx("input",{...c("securityNum",{required:{value:!0,message:"請填入信用卡安全碼"},pattern:{value:/^\d{3}$/,message:"安全碼格式錯誤"}}),type:"tel",className:`form-control fs-7 ${l.securityNum&&"is-invalid"}`,id:"securityNum",placeholder:"CVC",maxLength:"3"}),l.securityNum&&e.jsx("div",{className:"invalid-feedback",children:l.securityNum.message})]})})]})})]})]})]})})})]}),e.jsx("div",{className:"col-0 col-lg-4",children:e.jsx("section",{children:e.jsx("div",{className:"pt-3 pt-sm-0",children:e.jsx("div",{className:"bg-white p-3 rounded-3",children:e.jsxs("div",{children:[e.jsx("div",{className:"py-3",children:e.jsx("h6",{children:"訂單總計"})}),e.jsxs("div",{className:"d-flex py-3",children:[e.jsxs("p",{className:"text-neutral-80",children:[a.carts?(w=a==null?void 0:a.carts)==null?void 0:w.length:0,"項商品"]}),e.jsxs("h6",{className:"fs-7 ms-auto",children:["NT$",a.total?(k=a.total)==null?void 0:k.toLocaleString():0]})]}),e.jsxs("div",{className:"d-flex py-3",children:[e.jsx("p",{className:"text-neutral-80",children:"運費"}),e.jsxs("h6",{className:"fs-7 ms-auto",children:["NT$ ",i.toLocaleString()]})]}),e.jsx("hr",{className:"my-3"}),e.jsxs("div",{className:"d-flex py-3",children:[e.jsx("p",{className:"text-neutral-80",children:"折扣總額"}),e.jsxs("h6",{className:"fs-7 ms-auto",children:["-NT$",a.total?((a==null?void 0:a.total)-(a==null?void 0:a.final_total)).toLocaleString():0]})]}),e.jsxs("form",{onSubmit:s=>{s.preventDefault(),t(W(F))},className:"d-flex align-items-center py-3",children:[e.jsx("div",{children:e.jsx("input",{className:"form-control",type:"text",id:"useCoupon",placeholder:"請輸入折扣碼",onChange:s=>O(s.target.value)})}),e.jsx("div",{className:"ms-7 me-2",children:e.jsx(o,{type:"submit",btnName:"套用",btnColor:"primary-100"})}),e.jsx(se,{loadingSource:$,size:20})]}),e.jsx("hr",{className:"my-3"}),e.jsxs("div",{className:"d-flex py-3",children:[e.jsx("p",{className:"text-neutral-80 mt-auto",children:"總計"}),e.jsxs("h3",{className:"ms-auto",children:["NT$",a.final_total&&i?(a.final_total+i).toLocaleString():0]})]}),e.jsx("div",{className:"d-grid py-3",children:e.jsx("button",{className:"btn btn-primary-100 py-4 fs-7 ",type:"submit",form:"orderForm",lang:"zh-TW",children:"確認訂單"})}),e.jsx("div",{className:"mt-1 mb-3",children:e.jsx("p",{lang:"zh-TW",children:"確認購買即表示您已審閱NOMAD SURFER所提供購物相關條款，並同意條款內容。"})})]})})})})})]})})]})}export{pe as default};
